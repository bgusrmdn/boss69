<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <meta name="format-detection" content="telephone=no">
    <title>Demo Integrasi Cursor dengan Browser</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            background-attachment: fixed;
            background-size: cover;
            background-repeat: no-repeat;
            color: #333;
            min-height: 100vh;
            box-sizing: border-box;
        }
        
        * {
            box-sizing: border-box;
        }
        
        .container {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            width: 100%;
            max-width: 100%;
            overflow-x: auto;
        }
        
        h1 {
            color: #2c3e50;
            text-align: center;
            margin-bottom: 30px;
            font-size: clamp(1.8rem, 4vw, 2.5rem);
            word-wrap: break-word;
            line-height: 1.2;
        }
        
        .section {
            margin-bottom: 30px;
            padding: 20px;
            border-radius: 10px;
            background: #f8f9fa;
            border-left: 4px solid #007bff;
            width: 100%;
            overflow-wrap: break-word;
        }
        
        .button-group {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            margin: 15px 0;
            justify-content: flex-start;
            align-items: center;
        }
        
        .cursor-btn {
            background: linear-gradient(45deg, #007bff, #0056b3);
            color: white;
            padding: 12px 24px;
            text-decoration: none;
            border-radius: 8px;
            border: none;
            cursor: pointer;
            font-size: clamp(14px, 2vw, 16px);
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            white-space: nowrap;
            min-width: fit-content;
        }
        
        .cursor-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,123,255,0.3);
        }
        
        .cursor-btn::before {
            content: "üéØ";
            font-size: 18px;
        }
        
        .input-group {
            display: flex;
            gap: 10px;
            margin: 15px 0;
            align-items: center;
            flex-wrap: wrap;
        }
        
        input[type="text"] {
            flex: 1;
            min-width: 200px;
            padding: 10px;
            border: 2px solid #ddd;
            border-radius: 5px;
            font-size: clamp(14px, 2vw, 16px);
        }
        
        input[type="text"]:focus {
            outline: none;
            border-color: #007bff;
        }
        
        .status {
            margin: 15px 0;
            padding: 10px;
            border-radius: 5px;
            background: #e9ecef;
            border-left: 4px solid #6c757d;
        }
        
        .success {
            background: #d4edda;
            border-left-color: #28a745;
            color: #155724;
        }
        
        .error {
            background: #f8d7da;
            border-left-color: #dc3545;
            color: #721c24;
        }
        
        .warning {
            background: #fff3cd;
            border-left-color: #ffc107;
            color: #856404;
        }
        
        code {
            background: #f1f3f4;
            padding: 2px 5px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
            font-size: clamp(12px, 1.5vw, 14px);
            word-break: break-all;
            overflow-wrap: break-word;
        }
        
        .protocol-demo {
            background: #2c3e50;
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }
        
        .protocol-demo h3 {
            color: #ecf0f1;
            margin-top: 0;
        }
        
        .protocol-url {
            background: #34495e;
            padding: 10px;
            border-radius: 5px;
            font-family: monospace;
            font-size: clamp(12px, 1.5vw, 14px);
            word-break: break-all;
            overflow-wrap: break-word;
            margin: 10px 0;
            line-height: 1.4;
        }
        
        /* Media Queries untuk Responsiveness */
        @media (max-width: 768px) {
            body {
                padding: 10px;
                margin: 0;
            }
            
            .container {
                padding: 20px;
                margin: 0;
                border-radius: 10px;
            }
            
            h1 {
                font-size: 1.8rem;
                margin-bottom: 20px;
            }
            
            .section {
                padding: 15px;
                margin-bottom: 20px;
            }
            
            .button-group {
                gap: 10px;
                justify-content: center;
            }
            
            .cursor-btn {
                padding: 10px 16px;
                font-size: 14px;
                flex: 1;
                min-width: 120px;
                max-width: 200px;
                justify-content: center;
            }
            
            .input-group {
                flex-direction: column;
                align-items: stretch;
            }
            
            input[type="text"] {
                min-width: 100%;
                margin-bottom: 10px;
            }
            
            .protocol-url {
                font-size: 11px;
                padding: 8px;
            }
            
            .protocol-demo {
                padding: 15px;
            }
        }
        
        @media (max-width: 480px) {
            body {
                padding: 5px;
            }
            
            .container {
                padding: 15px;
                border-radius: 5px;
            }
            
            h1 {
                font-size: 1.5rem;
            }
            
            .section {
                padding: 12px;
            }
            
            .cursor-btn {
                padding: 8px 12px;
                font-size: 12px;
                min-width: 100px;
            }
            
            .protocol-url {
                font-size: 10px;
                padding: 6px;
            }
        }
        
        /* Zoom dan Scale Fix */
        @media (min-width: 1400px) {
            body {
                max-width: 1400px;
                font-size: 18px;
            }
            
            h1 {
                font-size: 3rem;
            }
            
            .cursor-btn {
                font-size: 18px;
                padding: 14px 28px;
            }
        }
        
        /* Print Styles */
        @media print {
            body {
                background: white;
                color: black;
            }
            
            .container {
                box-shadow: none;
                border: 1px solid #ccc;
            }
            
            .cursor-btn {
                background: #007bff;
                color: white;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üéØ Demo Integrasi Cursor dengan Browser</h1>
        
        <div class="section">
            <h2>üìÅ Buka Direktori Standar</h2>
            <p>Klik tombol di bawah untuk membuka direktori umum di Cursor:</p>
            
            <div class="button-group">
                <a href="cursor:///home/user/Documents" class="cursor-btn">Documents</a>
                <a href="cursor:///home/user/Desktop" class="cursor-btn">Desktop</a>
                <a href="cursor:///home/user/Downloads" class="cursor-btn">Downloads</a>
                <a href="cursor://~/workspace" class="cursor-btn">Workspace</a>
            </div>
        </div>
        
        <div class="section">
            <h2>üõ†Ô∏è Buka Path Custom</h2>
            <p>Masukkan path custom yang ingin dibuka di Cursor:</p>
            
            <div class="input-group">
                <input type="text" id="customPath" placeholder="/home/user/my-project" value="/workspace">
                <button class="cursor-btn" onclick="openCustomPath()">Buka di Cursor</button>
            </div>
            
            <div id="pathStatus" class="status" style="display: none;"></div>
        </div>
        
        <div class="section">
            <h2>üåê Test URL Protocols</h2>
            <p>Test berbagai format URL protocol untuk Cursor:</p>
            
            <div class="protocol-demo">
                <h3>Format yang Didukung:</h3>
                
                <div class="protocol-url">
                    <strong>Absolute Path:</strong> cursor:///home/user/project
                </div>
                
                <div class="protocol-url">
                    <strong>Home Directory:</strong> cursor://~/project
                </div>
                
                <div class="protocol-url">
                    <strong>Relative Path:</strong> cursor://./project
                </div>
                
                <div class="protocol-url">
                    <strong>Current Directory:</strong> cursor://.
                </div>
            </div>
            
            <div class="button-group">
                <button class="cursor-btn" onclick="testProtocol('cursor:///tmp')">Test /tmp</button>
                <button class="cursor-btn" onclick="testProtocol('cursor://~/')">Test Home</button>
                <button class="cursor-btn" onclick="testProtocol('cursor://.')">Test Current Dir</button>
            </div>
        </div>
        
        <div class="section">
            <h2>üîß Diagnostic Tools</h2>
            <p>Tools untuk membantu troubleshooting integrasi:</p>
            
            <div class="button-group">
                <button class="cursor-btn" onclick="checkProtocolSupport()">Check Protocol Support</button>
                <button class="cursor-btn" onclick="showUserAgent()">Show User Agent</button>
                <button class="cursor-btn" onclick="testPermissions()">Test Permissions</button>
            </div>
            
            <div id="diagnosticResult" class="status" style="display: none;"></div>
        </div>
        
        <div class="section">
            <h2>üìö Cara Menggunakan</h2>
            <ol>
                <li><strong>Instalasi:</strong> Jalankan script <code>install_cursor_secure.sh</code></li>
                <li><strong>Restart Browser:</strong> Tutup dan buka kembali browser Anda</li>
                <li><strong>Klik Link:</strong> Klik salah satu tombol "Open in Cursor" di atas</li>
                <li><strong>Allow Permission:</strong> Browser akan bertanya permission, klik "Allow"</li>
                <li><strong>Cursor Terbuka:</strong> Cursor akan membuka direktori yang dipilih</li>
            </ol>
            
            <div class="status warning">
                <strong>Catatan:</strong> Pertama kali menggunakan, browser akan meminta permission untuk membuka aplikasi eksternal. Pastikan untuk mengklik "Allow" atau "Open Application".
            </div>
        </div>
        
        <div class="section">
            <h2>üö® Troubleshooting</h2>
            
            <h3>Browser tidak mengenali protocol cursor://</h3>
            <p>Jalankan command berikut di terminal:</p>
            <code>xdg-mime default cursor.desktop x-scheme-handler/cursor</code>
            
            <h3>Permission denied</h3>
            <p>Periksa permission file:</p>
            <code>chmod +x ~/.local/bin/cursor</code>
            
            <h3>Cursor tidak terbuka</h3>
            <p>Test manual dengan:</p>
            <code>~/.local/share/cursor/cursor.AppImage --no-sandbox /path/to/test</code>
        </div>
    </div>

    <script>
        function openCustomPath() {
            const path = document.getElementById('customPath').value;
            const status = document.getElementById('pathStatus');
            
            if (!path.trim()) {
                showStatus('pathStatus', 'error', 'Path tidak boleh kosong!');
                return;
            }
            
            // Validasi basic path
            if (path.includes('..') || path.includes('<') || path.includes('>')) {
                showStatus('pathStatus', 'error', 'Path mengandung karakter yang tidak valid!');
                return;
            }
            
            showStatus('pathStatus', 'success', `Membuka: ${path}`);
            
            // Open dengan cursor protocol
            const cursorUrl = `cursor://${path}`;
            window.open(cursorUrl);
            
            // Update status setelah 2 detik
            setTimeout(() => {
                showStatus('pathStatus', 'warning', 'Jika Cursor tidak terbuka, periksa instalasi protocol handler.');
            }, 2000);
        }
        
        function testProtocol(url) {
            const status = document.getElementById('diagnosticResult');
            showStatus('diagnosticResult', 'success', `Testing: ${url}`);
            
            try {
                window.open(url);
                setTimeout(() => {
                    showStatus('diagnosticResult', 'success', `Protocol test berhasil untuk: ${url}`);
                }, 1000);
            } catch (error) {
                showStatus('diagnosticResult', 'error', `Error testing protocol: ${error.message}`);
            }
        }
        
        function checkProtocolSupport() {
            const status = document.getElementById('diagnosticResult');
            
            // Test apakah browser support custom protocols
            const testUrl = 'cursor://test';
            const supported = typeof window.navigator.registerProtocolHandler === 'function';
            
            let message = `Browser Protocol Support: ${supported ? '‚úÖ Supported' : '‚ùå Not Supported'}\n`;
            message += `User Agent: ${navigator.userAgent.substring(0, 50)}...\n`;
            message += `Platform: ${navigator.platform}\n`;
            message += `Test URL: ${testUrl}`;
            
            showStatus('diagnosticResult', supported ? 'success' : 'warning', message);
        }
        
        function showUserAgent() {
            const status = document.getElementById('diagnosticResult');
            const ua = navigator.userAgent;
            const platform = navigator.platform;
            const language = navigator.language;
            
            const message = `User Agent: ${ua}\nPlatform: ${platform}\nLanguage: ${language}`;
            showStatus('diagnosticResult', 'success', message);
        }
        
        function testPermissions() {
            const status = document.getElementById('diagnosticResult');
            
            // Test various browser capabilities
            const tests = {
                'Local Storage': typeof Storage !== 'undefined',
                'Geolocation': 'geolocation' in navigator,
                'Service Worker': 'serviceWorker' in navigator,
                'Protocol Handler': typeof navigator.registerProtocolHandler === 'function',
                'Clipboard': typeof navigator.clipboard !== 'undefined'
            };
            
            let message = 'Browser Capabilities:\n';
            for (const [test, result] of Object.entries(tests)) {
                message += `${test}: ${result ? '‚úÖ' : '‚ùå'}\n`;
            }
            
            showStatus('diagnosticResult', 'success', message);
        }
        
        function showStatus(elementId, type, message) {
            const element = document.getElementById(elementId);
            element.className = `status ${type}`;
            element.style.display = 'block';
            element.innerHTML = message.replace(/\n/g, '<br>');
        }
        
        // Auto-detect user home and update examples
        window.addEventListener('load', function() {
            // Try to detect common paths and update examples
            const pathInput = document.getElementById('customPath');
            
            // Set a reasonable default based on current location
            if (window.location.pathname.includes('workspace')) {
                pathInput.value = '/workspace';
            }
        });
        
        // Handle protocol registration for browsers that support it
        if (typeof navigator.registerProtocolHandler === 'function') {
            try {
                // Note: This usually requires user gesture and HTTPS
                console.log('Browser supports protocol handler registration');
            } catch (e) {
                console.log('Protocol handler registration not available:', e.message);
            }
        }
    </script>
</body>
</html>